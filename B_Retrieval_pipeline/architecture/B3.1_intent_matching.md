# B3.1: Intent Matching Strategy - Architecture Design

## Name
**B3.1: Intent Matching Strategy**

## Purpose
Matches questions to concepts based on intent analysis using keyword overlap, domain alignment, and intent type compatibility to identify the most relevant concepts for question answering through semantic relationship assessment.

## Input Files
- **Primary**: `outputs/B2_1_intent_layer_output.json`
- **Secondary**: `../A_concept_pipeline/outputs/A2.5_expanded_concepts.json`
- **Fallback**: `../A_concept_pipeline/outputs/A2.4_core_concepts.json`
- **Contains**: Question intent analysis and expanded concept vocabularies

## Output Files
- **Primary**: `outputs/B3_1_intent_matching_output.json`
- **Contains**: Intent-based concept matches with similarity scores and matching details

## Processing Logic

### Intent Similarity Calculation
- Computes **keyword overlap score** using Jaccard similarity between question intent keywords and concept vocabularies
- Applies **domain alignment bonus** (1.0 for exact match, 0.5 for different domains, 0.7 for general domains)
- Includes **intent type adjustment** with bonuses for analytical questions (1.1x) and penalties for comparative questions (0.9x)
- Combines scores using weighted formula: Keyword overlap (50%) + Domain alignment (30%) + Intent adjustment (20%)

### Concept Matching Process
- Processes **both expanded and core concept formats** with automatic format detection and handling
- Extracts **comprehensive keyword sets** combining original and expanded terms when available
- Calculates **similarity scores** for all concept-question pairs above minimum threshold (0.1)
- Generates **detailed matching metadata** including keyword overlap counts and domain match indicators

### Quality Assessment Framework
- Categorizes **match quality** based on top similarity score: Excellent (≥0.8), Good (≥0.6), Fair (≥0.4), Poor (<0.4)
- Calculates **matching confidence** using top score with variance bonus for consistent quality across matches
- Analyzes **score distribution** through average scores and variance measurements for match reliability assessment
- Provides **total match count** and **coverage statistics** for matching effectiveness evaluation

### Match Ranking and Selection
- Ranks **all matches** by similarity score in descending order for priority-based selection
- Limits results to **top 10 matches** to control downstream processing complexity while maintaining quality
- Preserves **complete matching details** including strategy identification and score components
- Maintains **concept metadata** for downstream processing requirements

## Key Decisions

### Similarity Metric Composition
- **Decision**: Use Jaccard similarity (50%) with domain alignment (30%) and intent type (20%) weighting
- **Rationale**: Balances semantic overlap with contextual factors for comprehensive matching assessment
- **Impact**: Provides nuanced matching scores but requires careful weight balancing for optimal performance

### Domain Alignment Strategy
- **Decision**: Apply graduated domain bonuses rather than binary domain matching
- **Rationale**: Acknowledges that general domain concepts can match specialized questions and vice versa
- **Impact**: Enables cross-domain matching while still preferring domain-aligned concepts

### Intent Type Adjustment Policy
- **Decision**: Apply small multiplicative adjustments (±10%) based on question intent type
- **Rationale**: Recognizes that different intent types have varying concept matching requirements
- **Impact**: Fine-tunes matching for intent patterns but maintains primary focus on semantic similarity

### Match Threshold Selection
- **Decision**: Use low similarity threshold (0.1) for inclusion with quality-based ranking
- **Rationale**: Captures weak but potentially valid relationships while relying on ranking for quality control
- **Impact**: Maximizes recall for edge cases but may include noise requiring downstream filtering

### Result Limitation Strategy
- **Decision**: Return top 10 matches rather than applying quality threshold cutoff
- **Rationale**: Provides consistent result set size for downstream processing while maintaining best quality
- **Impact**: Ensures predictable output volume but may include lower-quality matches when few high-quality matches exist

### Format Compatibility Approach
- **Decision**: Support both expanded concepts and core concepts with automatic format detection
- **Rationale**: Maintains compatibility across different pipeline execution scenarios and input availability
- **Impact**: Increases processing flexibility but adds format handling complexity