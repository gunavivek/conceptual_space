# A2.5.3: Hierarchical Clustering Expansion Strategy - Architecture Design

## Name
**A2.5.3: Hierarchical Clustering Expansion Strategy**

## Purpose
Expands concepts using hierarchical clustering to find concept relationships at different granularity levels, creating multi-level concept hierarchies that reveal both local and global semantic structures.

## Input File
- **Primary**: `outputs/A2.4_core_concepts.json`
- **Contains**: Core concepts with keywords, importance scores, and document associations

## Output Files
- **Primary**: `outputs/A2.5.3_hierarchical_expansion.json`
- **Contains**: Hierarchical clustering results with cluster assignments, merge history, and expansion mappings

## Processing Logic

### Distance Calculation Framework
- Implements **multi-factor distance metric** combining Jaccard keyword distance (40% weight)
- Incorporates **domain distance** (30% weight) with zero distance for same domain, 0.3 for different domains
- Includes **importance score distance** (20% weight) based on absolute difference in concept importance
- Adds **document overlap distance** (30% weight) using inverse Jaccard similarity of document sets

### Hierarchical Clustering Algorithm
- Uses **agglomerative clustering** starting with each concept as individual cluster
- Applies **average linkage** criterion for merging cluster pairs based on mean pairwise distances
- Continues merging until **maximum cluster count** reached (default 5 clusters)
- Records **merge history** with distances and cluster sizes for hierarchy reconstruction

### Cluster Characterization Process
- Extracts **representative keywords** from aggregated cluster member vocabularies using frequency ranking
- Identifies **dominant domain** through majority voting among cluster member domains
- Calculates **cluster coherence** as ratio of unique representative keywords to total keywords
- Measures **average importance** across cluster members for cluster quality assessment

### Expansion Generation Strategy
- Assigns concepts to **peer-level clusters** containing related concepts at same hierarchical level
- Aggregates **cluster representative keywords** as expansion vocabulary for member concepts
- Calculates **expansion ratios** comparing expanded vocabulary size to original concept vocabulary
- Generates **hierarchical relationship mappings** between concepts within same clusters

## Key Decisions

### Distance Metric Composition
- **Decision**: Use weighted combination of four distance components rather than single metric
- **Rationale**: Captures multiple aspects of concept relationships for more robust clustering
- **Impact**: Produces more meaningful clusters but requires careful weight balancing

### Linkage Criterion Selection
- **Decision**: Use average linkage over single or complete linkage
- **Rationale**: Balances cluster compactness with outlier tolerance for varied concept types
- **Impact**: Creates moderate-sized clusters avoiding both chaining effects and excessive fragmentation

### Cluster Count Strategy
- **Decision**: Set maximum cluster count to 5 rather than using automatic stopping criteria
- **Rationale**: Provides manageable number of concept groups while maintaining meaningful granularity
- **Impact**: Ensures consistent cluster structure but may not reflect natural concept boundaries

### Keyword Aggregation Method
- **Decision**: Use frequency-based ranking for representative keyword selection
- **Rationale**: Emphasizes terms that appear consistently across cluster members
- **Impact**: Produces coherent cluster vocabularies but may lose unique concept-specific terms

### Hierarchical Level Focus
- **Decision**: Focus on single hierarchical level (peer relationships) rather than multi-level hierarchy
- **Rationale**: Simplifies expansion logic while providing clear concept groupings
- **Impact**: Loses hierarchical depth but maintains computational efficiency

### Expansion Scope Limitation
- **Decision**: Limit expansion to within-cluster concepts only
- **Rationale**: Ensures expansion maintains semantic coherence through cluster membership
- **Impact**: Conservative expansion that prioritizes quality over breadth of vocabulary growth