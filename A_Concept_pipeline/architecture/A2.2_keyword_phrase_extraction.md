# A2.2: Keyword Phrase Extraction - Architecture Design

## Name
**A2.2: Keyword Phrase Extraction (BIZBOK DOMAIN-ENHANCED)**

## Purpose
Extracts significant keywords and phrases from preprocessed documents using TF-IDF analysis enhanced with BIZBOK domain intelligence, statistical methods, and semantic concept weighting to identify domain-relevant terms for concept formation and semantic analysis.

## Input Files
- **Primary**: `outputs/A2.1_preprocessed_documents.json`  
- **Secondary**: `outputs/A1.2_domain_detection_output.json`
- **Contains**: Cleaned documents + BIZBOK concept definitions, matched keywords, and domain classifications for intelligent keyword weighting

## Output Files
- **Primary**: `outputs/A2.2_keyword_extractions.json`
- **Secondary**: `outputs/A2.2_keyword_extractions.meta.json`
- **Contains**: Document-level keyword extractions with TF-IDF scores and statistical rankings

## Processing Logic

### Stage 1: BIZBOK Domain Intelligence Integration (NEW)
- **Dual Input Loading**: Loads both A2.1 preprocessed documents and A1.2 domain detection data  
- **Concept Keyword Extraction**: Mines BIZBOK concept definitions to build domain-specific vocabulary seeds
- **R4S Keyword Validation**: Leverages matched keywords from R4S semantic analysis for keyword validation
- **Domain-Aware Weighting**: Applies relevance multipliers to TF-IDF scores based on BIZBOK concept alignment
- **Semantic Context Expansion**: Uses concept definitions and matched keywords for enhanced term scoring

### Stage 2: Enhanced TF-IDF Calculation Framework  
- Implements **term frequency calculation** with normalized scoring across document length variations
- Calculates **inverse document frequency** using logarithmic scaling for corpus-wide term importance
- Applies **domain-enhanced TF-IDF weighting** combining statistical measures with BIZBOK concept relevance
- Supports **multi-tier scoring**: Base TF-IDF × Concept Relevance Multiplier × Domain-Specific Boosts

### Stage 3: Domain-Aware Keyword Extraction Pipeline
- Performs **concept-guided n-gram generation** prioritizing domain-relevant phrase patterns
- Applies **BIZBOK-enhanced filtering** preserving domain terminology with intelligent thresholds
- Implements **semantic relevance ranking** combining statistical significance with concept alignment  
- Executes **cross-pipeline validation** using R4S matched keywords for extraction quality assessment

### Phrase Recognition System
- Identifies **multi-word expressions** through statistical co-occurrence analysis
- Detects **domain-specific phrases** using curated phrase patterns for financial, technical, and healthcare domains
- Applies **phrase coherence scoring** measuring semantic unity of multi-word terms
- Maintains **phrase-to-constituent mapping** for granular analysis and expansion opportunities

### Statistical Analysis and Ranking
- Generates **keyword importance distributions** across documents for collection-level analysis
- Calculates **domain-specific keyword concentrations** measuring specialized vocabulary density
- Provides **comparative keyword analysis** showing term importance variations across domains
- Creates **extraction quality metrics** including coverage, precision, and domain alignment measures

## Key Decisions

### TF-IDF Implementation Approach
- **Decision**: Use standard TF-IDF with domain-specific term bonuses rather than modified TF-IDF variants
- **Rationale**: Maintains interpretable and comparable scores while accommodating domain expertise
- **Impact**: Provides reliable term importance ranking with domain awareness but may not capture subtle semantic relationships

### N-gram Range Selection
- **Decision**: Support unigrams through trigrams rather than extending to longer n-grams
- **Rationale**: Balances phrase detection capability with computational efficiency and noise reduction
- **Impact**: Captures most meaningful phrases while maintaining processing speed and result interpretability

### Domain Weighting Strategy
- **Decision**: Apply multiplicative bonuses (1.2-1.5x) for domain-specific terms rather than additive bonuses
- **Rationale**: Preserves relative importance relationships while boosting domain-relevant terminology
- **Impact**: Enhances domain-specific extraction without completely overriding statistical significance

### Filtering Threshold Configuration
- **Decision**: Use configurable frequency and significance thresholds rather than fixed cutoffs
- **Rationale**: Enables adaptation to varying document collection sizes and content characteristics
- **Impact**: Provides extraction flexibility but requires threshold tuning for optimal performance

### Phrase Detection Method
- **Decision**: Combine statistical co-occurrence with curated phrase patterns rather than using purely statistical approaches
- **Rationale**: Leverages both data-driven discovery and domain expertise for comprehensive phrase extraction
- **Impact**: Improves phrase quality but requires maintenance of domain-specific phrase patterns

### Keyword Limit Policy
- **Decision**: Extract variable number of keywords based on document length and content richness rather than fixed limits
- **Rationale**: Accommodates natural variation in document information density and importance distribution
- **Impact**: Provides appropriate extraction depth for each document but creates variable output sizes

## BIZBOK Domain Enhancement Results (Production)

### Processing Statistics (Test Dataset)
- **Documents Processed**: 5 documents with full BIZBOK enhancement  
- **BIZBOK Concepts Processed**: 147 concept definitions across domains
- **Terms Boosted**: 65 keywords received domain relevance multipliers
- **Documents Enhanced**: 5/5 (100% enhancement rate)
- **Enhancement Coverage**: All documents successfully processed with domain intelligence

### Keyword Extraction Performance
- **Unique Keywords**: 129 domain-enhanced terms extracted
- **Unique Phrases**: 94 contextual phrases identified  
- **Domain Relevance**: High-scoring keywords show strong alignment with financial domain concepts
- **Top Keywords**: "deferred", "income", "revenue", "balances" - all financially relevant terms boosted by BIZBOK concepts

### Domain Intelligence Impact
- **Concept Definition Mining**: Successfully extracted seed keywords from insurance, finance, and government concept definitions
- **R4S Integration**: Leveraged matched keywords from semantic analysis for validation and boosting
- **Multi-Domain Processing**: Handled mixed domains (insurance, government, manufacturing, international development org) with appropriate concept-specific enhancements
- **Document-Specific Term Prioritization**: Each document receives domain-appropriate boosts based on its BIZBOK classification

### Enhanced Domain-Specific Boosting Implementation
**Dynamic Multi-Tier Scoring System:**
- **2.0x boost**: Terms appearing in document's BIZBOK concept definitions
- **1.5x boost**: Terms matched by R4S semantic analysis for that document
- **1.3x boost**: Terms specific to document's classified domain:
  - **Insurance Documents**: "claim", "policy", "premium", "coverage", "risk", "underwriting"
  - **Finance Documents**: "income", "revenue", "payment", "transaction", "asset", "liability"
  - **Government Documents**: "regulation", "compliance", "public", "citizen", "service", "administration"
  - **Manufacturing Documents**: "production", "quality", "process", "material", "inventory", "supply"
  - **Transportation Documents**: "logistics", "shipping", "delivery", "route", "vehicle", "freight"

**Example: Insurance vs Government Document Processing:**
```
Insurance Document (finqa_test_617): 
  → "claim" gets 1.3x boost, "regulation" gets 1.0x (no boost)

Government Document (finqa_test_96):
  → "regulation" gets 1.3x boost, "claim" gets 1.0x (no boost)
```